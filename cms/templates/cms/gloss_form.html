{% extends "cms/base.html" %}
{% block title %}{% if mode == 'edit' %}Edit Gloss{% else %}Add Gloss{% endif %} | SBLL CMS{% endblock %}
{% block content %}
{{ languages_serialized|json_script:"shared-languages" }}
<h1 class="text-2xl font-semibold mb-4">{% if mode == 'edit' %}Edit gloss{% else %}Add gloss{% endif %}</h1>
{% if errors %}
<div class="alert alert-error mb-4">
  <ul class="list-disc list-inside">
    {% for error in errors %}<li>{{ error }}</li>{% endfor %}
  </ul>
</div>
{% endif %}
<form method="post" class="space-y-4">
  {% csrf_token %}
  <fieldset class="fieldset w-full">
    <label for="content" class="label">Content</label>
    <textarea id="content" name="content" class="textarea textarea-bordered w-full" rows="3" required>{{ data.content }}</textarea>
  </fieldset>
  <fieldset class="fieldset">
    <label for="language" class="label">Language</label>
    <select id="language" name="language" class="select select-bordered w-full" required>
      <option value="" disabled {% if not data.language %}selected{% endif %}>Select language</option>
      {% for language in languages %}
        <option value="{{ language.pk }}" {% if data.language and data.language.pk == language.pk %}selected{% endif %}>{{ language }}</option>
      {% endfor %}
    </select>
  </fieldset>
  <fieldset class="fieldset">
    <label for="transcriptions" class="label">Transcriptions (one per line)</label>
    <textarea id="transcriptions" name="transcriptions" class="textarea textarea-bordered" rows="4" placeholder="IPA&#10;Romanization">{{ data.transcriptions_raw }}</textarea>
  </fieldset>
  <div class="space-y-6">
    {% include "cms/includes/relation_selector.html" with field_name="contains" field_label="Contains" initial=relations_serialized.contains search_url=gloss_search_url create_url=gloss_create_url initial_id="data-contains" %}
    {% include "cms/includes/relation_selector.html" with field_name="near_synonyms" field_label="Near synonyms" initial=relations_serialized.near_synonyms search_url=gloss_search_url create_url=gloss_create_url initial_id="data-near-synonyms" %}
    {% include "cms/includes/relation_selector.html" with field_name="near_homophones" field_label="Near homophones" initial=relations_serialized.near_homophones search_url=gloss_search_url create_url=gloss_create_url initial_id="data-near-homophones" %}
    {% include "cms/includes/relation_selector.html" with field_name="translations" field_label="Translations" initial=relations_serialized.translations search_url=gloss_search_url create_url=gloss_create_url initial_id="data-translations" %}
    {% include "cms/includes/relation_selector.html" with field_name="clarifies_usage" field_label="Clarifies usage of" initial=relations_serialized.clarifies_usage search_url=gloss_search_url create_url=gloss_create_url initial_id="data-clarifies-usage" %}
    {% include "cms/includes/relation_selector.html" with field_name="to_be_differentiated_from" field_label="To be differentiated from" initial=relations_serialized.to_be_differentiated_from search_url=gloss_search_url create_url=gloss_create_url initial_id="data-to-be-differentiated-from" %}
    {% include "cms/includes/relation_selector.html" with field_name="collocations" field_label="Collocations" initial=relations_serialized.collocations search_url=gloss_search_url create_url=gloss_create_url initial_id="data-collocations" %}
  </div>
  <div class="flex gap-2">
    <button type="submit" class="btn btn-primary">Save</button>
    <a href="{% url 'gloss_list' %}" class="btn btn-ghost">Cancel</a>
  </div>
</form>
{% endblock %}
